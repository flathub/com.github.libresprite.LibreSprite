app-id: com.github.libresprite.LibreSprite
runtime: org.freedesktop.Platform
runtime-version: '24.08'
sdk: org.freedesktop.Sdk
command: libresprite
rename-appdata-file: io.github.libresprite.libresprite.metainfo.xml
rename-desktop-file: libresprite.desktop
rename-icon: libresprite
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --share=ipc
  - --device=dri
  - --filesystem=home
modules:
  - name: gtest
    buildsystem: cmake-ninja
    sources:
      - type: archive
        url: https://github.com/google/googletest/archive/refs/tags/v1.17.0.tar.gz
        sha256: 65fab701d9829d38cb77c14acdc431d2108bfdbf8979e40eb8ae567edf10b27c
        x-checker-data:
          type: anitya
          project-id: 18290
          url-template: https://github.com/google/googletest/archive/refs/tags/v$version.tar.gz
    cleanup:
      - '*'

  - name: tinyxml
    buildsystem: cmake-ninja
    sources:
      - type: git
        url: https://github.com/leethomason/tinyxml2.git
        tag: 11.0.0
    cleanup:
      - '*'

  - name: libresprite
    buildsystem: cmake-ninja
    builddir: true
    config-opts:
      - -Wno-dev
      - -DWITH_DESKTOP_INTEGRATION=ON
    sources:
  # use git, so that submodules don't have to be added as sources to the module
      - type: git
        url: https://github.com/LibreSprite/LibreSprite
        commit: 5cb089be32f56b4ae559ae51f0c5666049f41bca
        x-checker-data:
          type: anitya
          project-id: 153525
          tag-template: v$version
          stable-only: true
        tag: v1.2

        # LibreSprite-provided meta does not currently contain developer information
        # Until it does, we provide a version with developer information added
      - type: patch
        path: patches/com.github.libresprite.libresprite.metainfo.xml.patch
    post-install:
      - install -Dm644 /app/share/libresprite/data/icons/ase64.png /app/share/icons/hicolor/64x64/apps/libresprite.png

